<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Exponential random graph models with R</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Exponential random graph models with R">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Exponential random graph models with R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Exponential random graph models with R" />
  
  
  

<meta name="author" content="Alberto Caimo and Isabella Gollini">


<meta name="date" content="2017-04-10">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="MLE-ERGMs.html">


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Network Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the authors</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#alberto-caimo"><i class="fa fa-check"></i>Alberto Caimo</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#isabella-gollini"><i class="fa fa-check"></i>Isabella Gollini</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="Rbasics.html"><a href="Rbasics.html"><i class="fa fa-check"></i><b>2</b> R basics</a><ul>
<li class="chapter" data-level="2.1" data-path="Rbasics.html"><a href="Rbasics.html#fundamentals"><i class="fa fa-check"></i><b>2.1</b> Fundamentals</a></li>
<li class="chapter" data-level="2.2" data-path="Rbasics.html"><a href="Rbasics.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.2</b> R and RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="Rbasics.html"><a href="Rbasics.html#package-repositories"><i class="fa fa-check"></i><b>2.3</b> Package repositories</a></li>
<li class="chapter" data-level="2.4" data-path="Rbasics.html"><a href="Rbasics.html#r-packages-for-statistical-network-analysis"><i class="fa fa-check"></i><b>2.4</b> R packages for statistical network analysis</a><ul>
<li class="chapter" data-level="2.4.1" data-path="Rbasics.html"><a href="Rbasics.html#statnet"><i class="fa fa-check"></i><b>2.4.1</b> <code>statnet</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="Rbasics.html"><a href="Rbasics.html#bergm"><i class="fa fa-check"></i><b>2.4.2</b> <code>Bergm</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="RGM.html"><a href="RGM.html"><i class="fa fa-check"></i><b>3</b> The random graph model</a><ul>
<li class="chapter" data-level="3.1" data-path="RGM.html"><a href="RGM.html#networks-as-random-graphs"><i class="fa fa-check"></i><b>3.1</b> Networks as random graphs</a><ul>
<li class="chapter" data-level="3.1.1" data-path="RGM.html"><a href="RGM.html#notation"><i class="fa fa-check"></i><b>3.1.1</b> Notation</a></li>
<li class="chapter" data-level="3.1.2" data-path="RGM.html"><a href="RGM.html#visualisation"><i class="fa fa-check"></i><b>3.1.2</b> Visualisation</a></li>
<li class="chapter" data-level="3.1.3" data-path="RGM.html"><a href="RGM.html#number-of-dyads"><i class="fa fa-check"></i><b>3.1.3</b> Number of dyads</a></li>
<li class="chapter" data-level="3.1.4" data-path="RGM.html"><a href="RGM.html#number-of-edges"><i class="fa fa-check"></i><b>3.1.4</b> Number of edges</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="RGM.html"><a href="RGM.html#random-graph-model"><i class="fa fa-check"></i><b>3.2</b> Random graph model</a><ul>
<li class="chapter" data-level="3.2.1" data-path="RGM.html"><a href="RGM.html#estimation"><i class="fa fa-check"></i><b>3.2.1</b> Estimation</a></li>
<li class="chapter" data-level="3.2.2" data-path="RGM.html"><a href="RGM.html#natural-parametrisation"><i class="fa fa-check"></i><b>3.2.2</b> Natural parametrisation</a></li>
<li class="chapter" data-level="3.2.3" data-path="RGM.html"><a href="RGM.html#parameter-interpretation"><i class="fa fa-check"></i><b>3.2.3</b> Parameter interpretation</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="RGM.html"><a href="RGM.html#network-simulation"><i class="fa fa-check"></i><b>3.3</b> Network simulation</a><ul>
<li class="chapter" data-level="3.3.1" data-path="RGM.html"><a href="RGM.html#histogram"><i class="fa fa-check"></i><b>3.3.1</b> Histogram</a></li>
<li class="chapter" data-level="3.3.2" data-path="RGM.html"><a href="RGM.html#boxplot"><i class="fa fa-check"></i><b>3.3.2</b> Boxplot</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="RGM.html"><a href="RGM.html#network-statistics"><i class="fa fa-check"></i><b>3.4</b> Network statistics</a><ul>
<li class="chapter" data-level="3.4.1" data-path="RGM.html"><a href="RGM.html#degree-distribution"><i class="fa fa-check"></i><b>3.4.1</b> Degree distribution</a></li>
<li class="chapter" data-level="3.4.2" data-path="RGM.html"><a href="RGM.html#edgewise-shared-partners-distribution"><i class="fa fa-check"></i><b>3.4.2</b> Edgewise shared partners distribution</a></li>
<li class="chapter" data-level="3.4.3" data-path="RGM.html"><a href="RGM.html#geodesic-distance-distribution"><i class="fa fa-check"></i><b>3.4.3</b> Geodesic distance distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="RGM.html"><a href="RGM.html#goodness-of-fit-diagnostics"><i class="fa fa-check"></i><b>3.5</b> Goodness of fit diagnostics</a><ul>
<li class="chapter" data-level="3.5.1" data-path="RGM.html"><a href="RGM.html#graphical-diagnostics"><i class="fa fa-check"></i><b>3.5.1</b> Graphical diagnostics</a></li>
<li class="chapter" data-level="3.5.2" data-path="RGM.html"><a href="RGM.html#summaries"><i class="fa fa-check"></i><b>3.5.2</b> Summaries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ERGMs.html"><a href="ERGMs.html"><i class="fa fa-check"></i><b>4</b> Exponential random graph models (ERGMs)</a><ul>
<li class="chapter" data-level="4.1" data-path="ERGMs.html"><a href="ERGMs.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="ERGMs.html"><a href="ERGMs.html#dependence-assumptions"><i class="fa fa-check"></i><b>4.2</b> Dependence assumptions</a><ul>
<li class="chapter" data-level="4.2.1" data-path="ERGMs.html"><a href="ERGMs.html#dyadic-independence"><i class="fa fa-check"></i><b>4.2.1</b> Dyadic independence</a></li>
<li class="chapter" data-level="4.2.2" data-path="ERGMs.html"><a href="ERGMs.html#dyadic-dependence"><i class="fa fa-check"></i><b>4.2.2</b> Dyadic dependence</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ERGMs.html"><a href="ERGMs.html#network-statistics-1"><i class="fa fa-check"></i><b>4.3</b> Network statistics</a><ul>
<li class="chapter" data-level="4.3.1" data-path="ERGMs.html"><a href="ERGMs.html#higher-order-network-statistics"><i class="fa fa-check"></i><b>4.3.1</b> Higher-order network statistics</a></li>
<li class="chapter" data-level="4.3.2" data-path="ERGMs.html"><a href="ERGMs.html#statistics-with-nodal-attributes-variables"><i class="fa fa-check"></i><b>4.3.2</b> Statistics with nodal attributes variables</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ERGMs.html"><a href="ERGMs.html#parameter-interpretation-1"><i class="fa fa-check"></i><b>4.4</b> Parameter interpretation</a></li>
<li class="chapter" data-level="4.5" data-path="ERGMs.html"><a href="ERGMs.html#network-simulation-1"><i class="fa fa-check"></i><b>4.5</b> Network simulation</a><ul>
<li class="chapter" data-level="4.5.1" data-path="ERGMs.html"><a href="ERGMs.html#trace-and-density-plots"><i class="fa fa-check"></i><b>4.5.1</b> Trace and density plots</a></li>
<li class="chapter" data-level="4.5.2" data-path="ERGMs.html"><a href="ERGMs.html#auto-correlation-plots"><i class="fa fa-check"></i><b>4.5.2</b> Auto-correlation plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="MLE-ERGMs.html"><a href="MLE-ERGMs.html"><i class="fa fa-check"></i><b>5</b> Maximum likelihood estimation for ERGMs</a><ul>
<li class="chapter" data-level="5.1" data-path="MLE-ERGMs.html"><a href="MLE-ERGMs.html#monte-carlo-maximum-likelihood-estimation-mc-mle"><i class="fa fa-check"></i><b>5.1</b> Monte Carlo maximum likelihood estimation (MC-MLE)</a></li>
<li class="chapter" data-level="5.2" data-path="MLE-ERGMs.html"><a href="MLE-ERGMs.html#goodness-of-fit-diagnostics-1"><i class="fa fa-check"></i><b>5.2</b> Goodness of fit diagnostics</a><ul>
<li class="chapter" data-level="5.2.1" data-path="MLE-ERGMs.html"><a href="MLE-ERGMs.html#graphical-diagnostics-1"><i class="fa fa-check"></i><b>5.2.1</b> Graphical diagnostics</a></li>
<li class="chapter" data-level="5.2.2" data-path="MLE-ERGMs.html"><a href="MLE-ERGMs.html#summaries-1"><i class="fa fa-check"></i><b>5.2.2</b> Summaries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Bayes-ERGMs.html"><a href="Bayes-ERGMs.html"><i class="fa fa-check"></i><b>6</b> Bayesian inference for ERGMs</a><ul>
<li class="chapter" data-level="6.1" data-path="Bayes-ERGMs.html"><a href="Bayes-ERGMs.html#parameter-inference-via-approximate-exchange-algorithm"><i class="fa fa-check"></i><b>6.1</b> Parameter inference via approximate exchange algorithm</a><ul>
<li class="chapter" data-level="6.1.1" data-path="Bayes-ERGMs.html"><a href="Bayes-ERGMs.html#parallel-adaptive-direction-sampler"><i class="fa fa-check"></i><b>6.1.1</b> Parallel adaptive direction sampler</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="Bayes-ERGMs.html"><a href="Bayes-ERGMs.html#prior-specification"><i class="fa fa-check"></i><b>6.2</b> Prior specification</a></li>
<li class="chapter" data-level="6.3" data-path="Bayes-ERGMs.html"><a href="Bayes-ERGMs.html#bayesian-goodness-of-fit-diagnostics"><i class="fa fa-check"></i><b>6.3</b> Bayesian goodness of fit diagnostics</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exponential random graph models with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Bayes_ERGMs" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Bayesian inference for ERGMs</h1>
<div id="parameter-inference-via-approximate-exchange-algorithm" class="section level2">
<h2><span class="header-section-number">6.1</span> Parameter inference via approximate exchange algorithm</h2>
<p>Bayesian inference for ERGMs is based on the posterior distribution of <span class="math inline">\(\theta\)</span> given the data <span class="math inline">\(y\)</span>: <span class="math display">\[
p(\theta | y) 
= p(y | \theta)\; \frac{p(\theta)}{p(y)} 
= \frac{ \exp \{ \theta^t s(y)\} }
       {z(\theta)}\; \frac{p(\theta)}{p(y)},
\]</span> where <span class="math inline">\(p(\theta)\)</span> is the prior parameter distribution and <span class="math inline">\(p(y)\)</span> is the evidence or marginal likelihood of <span class="math inline">\(y\)</span> which is typically intractable.</p>
<p>Standard MCMC methods such as the Metropolis-Hastings algorithm, can deal with posterior estimation as long as the target posterior density is known up to the model evidence <span class="math inline">\(p(y)\)</span>. Unfortunately in the ERGM context the posterior density <span class="math inline">\(p(\theta | y)\)</span> of non-trivially small ERGMs includes two intractable normalising constants, the model evidence <span class="math inline">\(p(y)\)</span> and <span class="math inline">\(z(\theta)\)</span>. For this reason, the ERGM posterior density is <strong>doubly intractable</strong>.</p>
<p>In order to carry out Bayesian inference for ERGMs, the <code>Bergm</code> package makes use of MCMC techniques <span class="citation">(Caimo and Friel <a href="#ref-cai:fri11">2011</a>)</span>. The <em>approximate exchange algorithm</em> circumvents the problem of computing the normalising constants of the ERGM likelihoods, while the use of multiple chains and efficient adaptive proposal strategies are able to speed up the computations and improve chain mixing quite significantly.</p>
<p>Let’s denote <span class="math inline">\(q_{\theta}(y) = \exp \{ \theta^t s(y) \}\)</span> the unnormalised likelihood. The approximate exchange algorithm implemented by the <code>bergm</code> function can be summarised in the following way:</p>
<ol style="list-style-type: decimal">
<li>Gibbs update of <span class="math inline">\((\theta&#39;,y&#39;)\)</span></li>
</ol>
<p><span class="math inline">\(\qquad\)</span>i) Draw <span class="math inline">\(\theta&#39; \sim h(\cdot|\theta)\)</span></p>
<ol start="2" style="list-style-type: lower-roman">
<li>Approximately draw <span class="math inline">\(y&#39; \sim f(\cdot|\theta&#39;)\)</span> via MCMC</li>
</ol>
<ol start="2" style="list-style-type: decimal">
<li>Accept move from <span class="math inline">\(\theta\)</span> to <span class="math inline">\(\theta&#39;\)</span> with probability: <span class="math display">\[
        1 \wedge \frac{q_{\theta&#39;}(y)}{q_{\theta}(y)}
        \frac{p(\theta&#39;)}{p(\theta)} 
        \frac{h(\theta|\theta&#39;)}{h(\theta&#39;|\theta)}
        \frac{q_{\theta}(y&#39;)}{q_{\theta&#39;}(y&#39;)} 
        \times \underbrace{\frac{z(\theta)z(\theta&#39;)}{z(\theta&#39;)z(\theta)}}_{1}.
        \]</span></li>
</ol>
<div id="parallel-adaptive-direction-sampler" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Parallel adaptive direction sampler</h3>
<p>In order to improve mixing a parallel adaptive direction sampler (ADS) <span class="citation">(Gilks, Roberts, and George <a href="#ref-gil:rob:geo94">1994</a>; Roberts and Gilks <a href="#ref-rob:gil94">1994</a>)</span> is considered: at the <span class="math inline">\(i\)</span>-th iteration of the algorithm we have a collection of <span class="math inline">\(H\)</span> different chains interacting with one another. By construction, the state space consists of <span class="math inline">\(\{\theta_1,\dots,\theta_H\}\)</span> with target distribution <span class="math inline">\(p(\theta_1|y)\otimes\dots\otimes p(\theta_H | y)\)</span>. A parallel ADS move consists of generating a new value <span class="math inline">\(\theta&#39;_h\)</span> from the difference of two parameters <span class="math inline">\(\theta_{h_1}\)</span> and <span class="math inline">\(\theta_{h_2}\)</span> (randomly selected from other chains) multiplied by a scalar term <span class="math inline">\(\gamma\)</span> which is called parallel ADS move factor plus a random term <span class="math inline">\(\epsilon\)</span> called parallel ADS move parameter.</p>
<p>Consider the Zachary Karate club social network consisting of social relations in a university karate club involving 34 individuals. The nodal covariate <code>faction.id</code> is encoding the faction alignment coded numerically, as -2 (strongly Mr. Hi’s), -1 (weakly Mr. Hi’s), 0 (neutral), +1 (weakly John’s), and +2 (strongly John’s):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Bergm); <span class="kw">library</span>(statnet)
<span class="kw">data</span>(zach)
y &lt;-<span class="st"> </span>zach
y.node.col &lt;-<span class="st"> </span><span class="kw">rainbow</span>(<span class="dv">6</span>)[y %v%<span class="st"> &quot;faction.id&quot;</span> +<span class="st"> </span><span class="dv">3</span>]
<span class="kw">set.seed</span>(<span class="dv">11</span>)
<span class="kw">plot</span>(y, <span class="dt">vertex.col =</span> y.node.col, <span class="dt">vertex.cex =</span> <span class="fl">1.3</span>)
<span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,  
       <span class="dt">pch =</span> <span class="dv">16</span>, 
       <span class="dt">col =</span> <span class="kw">rainbow</span>(<span class="dv">6</span>)[<span class="kw">sort</span>(<span class="kw">unique</span>(y %v%<span class="st"> &quot;faction.id&quot;</span>) +<span class="st"> </span><span class="dv">3</span>)], 
       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;strongly Mr. Hi&#39;s&quot;</span>, 
                  <span class="st">&quot;weakly Mr. Hi&#39;s&quot;</span>, 
                  <span class="st">&quot;neutral&quot;</span>, 
                  <span class="st">&quot;weakly John&#39;s&quot;</span>, 
                  <span class="st">&quot;strongly John&#39;s&quot;</span>), 
       <span class="dt">title =</span> <span class="st">&#39;Faction&#39;</span>)</code></pre></div>
<p><img src="SNA_BOOK_files/figure-html/unnamed-chunk-41-1.png" width="384" /></p>
<p>and consider the following model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model<span class="fl">.3</span> &lt;-<span class="st"> </span>y ~<span class="st"> </span>edges +<span class="st"> </span>
<span class="st">               </span><span class="kw">nodematch</span>(<span class="st">&quot;faction.id&quot;</span>) +
<span class="st">               </span><span class="kw">gwesp</span>(<span class="dt">decay =</span> <span class="kw">log</span>(<span class="dv">2</span>), <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</code></pre></div>
</div>
</div>
<div id="prior-specification" class="section level2">
<h2><span class="header-section-number">6.2</span> Prior specification</h2>
<p>We can also set up the prior mean and variance/covariance structure. The prior distribution used by the <code>Bergm</code> package is the normal distribution. In this case, we set the prior mean to be <span class="math inline">\(\bar{\theta} = (-1, 0.5, 0)\)</span> (corresponding to negative density and positive density withing factions and positive transitivity) and the covariance matrix of each model to be a diagonal matrix with every entry equal to <span class="math inline">\(4\)</span>. So <span class="math display">\[
\theta \sim N \left(\begin{bmatrix}
-1\\ 
0.5\\ 
0.5
\end{bmatrix},
\begin{bmatrix}
4 &amp; 0 &amp; 0\\ 
0 &amp; 4 &amp; 0\\ 
0 &amp; 0 &amp; 4
\end{bmatrix}
\right)
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mean.prior &lt;-<span class="st"> </span><span class="kw">c</span>(-<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>)
sigma.prior &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">4</span>, <span class="dv">3</span>)</code></pre></div>
<p>To implement the Bayesian parameter inference procedure we can use the <code>bergm</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">post &lt;-<span class="st"> </span><span class="kw">bergm</span>(model<span class="fl">.3</span>, 
              <span class="dt">aux.iters =</span> <span class="dv">2000</span>, <span class="co"># number of iterations for step 1.ii</span>
              <span class="dt">burn.in =</span> <span class="dv">100</span>, <span class="co"># number of burnin iterations for each chain</span>
              <span class="dt">main.iters =</span> <span class="dv">3000</span>, <span class="co"># number of iterations for each chain (after burnin)</span>
              <span class="dt">nchains =</span> <span class="dv">5</span>, <span class="co"># number of chains</span>
              <span class="dt">gamma =</span> <span class="fl">0.8</span>, <span class="co"># gamma parameter (tuned to get ~20% acceptance probability)</span>
              <span class="dt">mean.prior =</span> mean.prior,
              <span class="dt">sigma.prior =</span> sigma.prior)</code></pre></div>
<p>It is possible to visualise the results of the MCMC estimation by using the <code>bergm.output</code> function which is based on the <code>coda</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bergm.output</span>(post)</code></pre></div>
<pre><code>## 
##  Posterior Density Estimate for Model: y ~ edges + nodematch(&quot;faction.id&quot;) + gwesp(decay = log(2), fixed = TRUE) 
##  
##                                              Mean        SD    Naive SE
## theta1 (edges)                         -3.2221441 0.2548631 0.002080948
## theta2 (nodematch.faction.id)           1.0492332 0.2318037 0.001892669
## theta3 (gwesp.fixed.0.693147180559945)  0.6070649 0.1359139 0.001109732
##                                        Time-series SE
## theta1 (edges)                            0.012117759
## theta2 (nodematch.faction.id)             0.011372732
## theta3 (gwesp.fixed.0.693147180559945)    0.006532328
## 
##                                              2.5%        25%        50%
## theta1 (edges)                         -3.7453945 -3.3850316 -3.2117128
## theta2 (nodematch.faction.id)           0.5937836  0.8970344  1.0494414
## theta3 (gwesp.fixed.0.693147180559945)  0.3594777  0.5150651  0.6046604
##                                              75%      97.5%
## theta1 (edges)                         -3.052811 -2.7196526
## theta2 (nodematch.faction.id)           1.205293  1.5186659
## theta3 (gwesp.fixed.0.693147180559945)  0.695165  0.8978658
## 
##  Acceptance rate: 0.1824667 
##  
## </code></pre>
</div>
<div id="bayesian-goodness-of-fit-diagnostics" class="section level2 tabset tabset-fade">
<h2><span class="header-section-number">6.3</span> Bayesian goodness of fit diagnostics</h2>
<p>The <code>bgof</code> function provides a useful tool for assessing Bayesian goodness-of-fit so as to examine the fit of the data to the posterior model obtained by the <code>bergm</code> function. The observed network data <span class="math inline">\(y\)</span> are compared with a set of networks <span class="math inline">\(y_1, y_2, \dots, y_S\)</span> simulated from <span class="math inline">\(S\)</span> independent realisations <span class="math inline">\(\theta_1, \theta_2,\dots,\theta_S\)</span> of the posterior density estimate. This comparison is made in terms of high-level characteristics <span class="math inline">\(g(\cdot)\)</span> such as higher degree distributions, etc. <span class="citation">(D. R. Hunter, Goodreau, and Handcock <a href="#ref-hun:goo:han08">2008</a>)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bgof</span>(post, <span class="dt">aux.iters =</span> <span class="dv">5000</span>, <span class="dt">n.deg =</span> <span class="dv">15</span>, <span class="dt">n.dist =</span> <span class="dv">9</span>, <span class="dt">n.esp =</span> <span class="dv">8</span>)</code></pre></div>
<p><img src="SNA_BOOK_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>The red line displays the goodness of fit statistics for the observed data together with boxplots of goodness of fit statistics based on <span class="math inline">\(100\)</span> simulated networks from the estimated posterior distribution.</p>

<div id="refs" class="references">
<div>
<p>Albert, Réka, and Albert László Barabási. 2002. “Statistical Mechanics of Complex Networks.” <em>Reviews of Modern Physics</em> 74 (1). APS: 47.</p>
</div>
<div>
<p>Caimo, A., and N. Friel. 2011. “Bayesian Inference for Exponential Random Graph Models.” <em>Social Networks</em> 33 (1, 1): 41–55.</p>
</div>
<div>
<p>———. 2014. “Bergm: Bayesian Exponential Random Graphs in R.” <em>Journal of Statistical Software</em> 61 (2): 1–25.</p>
</div>
<div>
<p>Gilks, W. R., G. O. Roberts, and E. I. George. 1994. “Adaptive Direction Sampling.” <em>Statistician</em> 43 (1): 179–89.</p>
</div>
<div>
<p>Handcock, Mark S., David R. Hunter, Carter T. Butts, Steven M. Goodreau, Pavel N. Krivitsky, Skye Bender-deMoll, and Martina Morris. 2016. <em>Statnet: Software Tools for the Statistical Analysis of Network Data</em>. The Statnet Project (<a href="http://www.statnet.org" class="uri">http://www.statnet.org</a>). <a href="CRAN.R-project.org/package=statnet" class="uri">CRAN.R-project.org/package=statnet</a>.</p>
</div>
<div>
<p>Holland, P. W., and S. Leinhardt. 1981. “An Exponential Family of Probability Distributions for Directed Graphs (with Discussion).” <em>Journal of the American Statistical Association</em> 76: 33–65.</p>
</div>
<div>
<p>Hunter, D. R., S. M. Goodreau, and M. S. Handcock. 2008. “Goodness of Fit of Social Network Models.” <em>Journal of the American Statistical Association</em> 103 (481): 248–58.</p>
</div>
<div>
<p>R Core Team. 2016. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/" class="uri">https://www.R-project.org/</a>.</p>
</div>
<div>
<p>Roberts, G. O., and W. R. Gilks. 1994. “Convergence of Adaptive Direction Sampling.” <em>Journal of Multivariate Analysis</em> 49 (2): 287–98.</p>
</div>
<div>
<p>Robins, Garry, Peter Elliott, and Philippa Pattison. 2001. “Network Models for Social Selection Processes.” <em>Social Networks</em> 23 (1). Elsevier: 1–30.</p>
</div>
<div>
<p>Schweinberger, Michael. 2011. “Instability, Sensitivity, and Degeneracy of Discrete Exponential Families.” <em>Journal of the American Statistical Association</em> 106 (496). Taylor &amp; Francis: 1361–70.</p>
</div>
<div>
<p>Snijders, T. A. B., P. E. Pattison, G. L. Robins, and Handcock M. S. 2006. “New Specifications for Exponential Random Graph Models.” <em>Sociological Methodology</em> 36: 99–153.</p>
</div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-cai:fri11">
<p>Caimo, A., and N. Friel. 2011. “Bayesian Inference for Exponential Random Graph Models.” <em>Social Networks</em> 33 (1, 1): 41–55.</p>
</div>
<div id="ref-gil:rob:geo94">
<p>Gilks, W. R., G. O. Roberts, and E. I. George. 1994. “Adaptive Direction Sampling.” <em>Statistician</em> 43 (1): 179–89.</p>
</div>
<div id="ref-rob:gil94">
<p>Roberts, G. O., and W. R. Gilks. 1994. “Convergence of Adaptive Direction Sampling.” <em>Journal of Multivariate Analysis</em> 49 (2): 287–98.</p>
</div>
<div id="ref-hun:goo:han08">
<p>Hunter, D. R., S. M. Goodreau, and M. S. Handcock. 2008. “Goodness of Fit of Social Network Models.” <em>Journal of the American Statistical Association</em> 103 (481): 248–58.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="MLE-ERGMs.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>


<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/06-Bayes_ERGMs.Rmd",
"text": "Edit"
},
"download": ["SNA_BOOK.pdf", "SNA_BOOK.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
