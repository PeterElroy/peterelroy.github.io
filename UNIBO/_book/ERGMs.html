<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Exponential random graph models with R</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Exponential random graph models with R">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Exponential random graph models with R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Exponential random graph models with R" />
  
  
  

<meta name="author" content="Alberto Caimo and Isabella Gollini">


<meta name="date" content="2017-04-10">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="RGM.html">
<link rel="next" href="MLE-ERGMs.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Network Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the authors</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#alberto-caimo"><i class="fa fa-check"></i>Alberto Caimo</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#isabella-gollini"><i class="fa fa-check"></i>Isabella Gollini</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="Rbasics.html"><a href="Rbasics.html"><i class="fa fa-check"></i><b>2</b> R basics</a><ul>
<li class="chapter" data-level="2.1" data-path="Rbasics.html"><a href="Rbasics.html#fundamentals"><i class="fa fa-check"></i><b>2.1</b> Fundamentals</a></li>
<li class="chapter" data-level="2.2" data-path="Rbasics.html"><a href="Rbasics.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.2</b> R and RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="Rbasics.html"><a href="Rbasics.html#package-repositories"><i class="fa fa-check"></i><b>2.3</b> Package repositories</a></li>
<li class="chapter" data-level="2.4" data-path="Rbasics.html"><a href="Rbasics.html#r-packages-for-statistical-network-analysis"><i class="fa fa-check"></i><b>2.4</b> R packages for statistical network analysis</a><ul>
<li class="chapter" data-level="2.4.1" data-path="Rbasics.html"><a href="Rbasics.html#statnet"><i class="fa fa-check"></i><b>2.4.1</b> <code>statnet</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="Rbasics.html"><a href="Rbasics.html#bergm"><i class="fa fa-check"></i><b>2.4.2</b> <code>Bergm</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="RGM.html"><a href="RGM.html"><i class="fa fa-check"></i><b>3</b> The random graph model</a><ul>
<li class="chapter" data-level="3.1" data-path="RGM.html"><a href="RGM.html#networks-as-random-graphs"><i class="fa fa-check"></i><b>3.1</b> Networks as random graphs</a><ul>
<li class="chapter" data-level="3.1.1" data-path="RGM.html"><a href="RGM.html#notation"><i class="fa fa-check"></i><b>3.1.1</b> Notation</a></li>
<li class="chapter" data-level="3.1.2" data-path="RGM.html"><a href="RGM.html#visualisation"><i class="fa fa-check"></i><b>3.1.2</b> Visualisation</a></li>
<li class="chapter" data-level="3.1.3" data-path="RGM.html"><a href="RGM.html#number-of-dyads"><i class="fa fa-check"></i><b>3.1.3</b> Number of dyads</a></li>
<li class="chapter" data-level="3.1.4" data-path="RGM.html"><a href="RGM.html#number-of-edges"><i class="fa fa-check"></i><b>3.1.4</b> Number of edges</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="RGM.html"><a href="RGM.html#random-graph-model"><i class="fa fa-check"></i><b>3.2</b> Random graph model</a><ul>
<li class="chapter" data-level="3.2.1" data-path="RGM.html"><a href="RGM.html#estimation"><i class="fa fa-check"></i><b>3.2.1</b> Estimation</a></li>
<li class="chapter" data-level="3.2.2" data-path="RGM.html"><a href="RGM.html#natural-parametrisation"><i class="fa fa-check"></i><b>3.2.2</b> Natural parametrisation</a></li>
<li class="chapter" data-level="3.2.3" data-path="RGM.html"><a href="RGM.html#parameter-interpretation"><i class="fa fa-check"></i><b>3.2.3</b> Parameter interpretation</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="RGM.html"><a href="RGM.html#network-simulation"><i class="fa fa-check"></i><b>3.3</b> Network simulation</a><ul>
<li class="chapter" data-level="3.3.1" data-path="RGM.html"><a href="RGM.html#histogram"><i class="fa fa-check"></i><b>3.3.1</b> Histogram</a></li>
<li class="chapter" data-level="3.3.2" data-path="RGM.html"><a href="RGM.html#boxplot"><i class="fa fa-check"></i><b>3.3.2</b> Boxplot</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="RGM.html"><a href="RGM.html#network-statistics"><i class="fa fa-check"></i><b>3.4</b> Network statistics</a><ul>
<li class="chapter" data-level="3.4.1" data-path="RGM.html"><a href="RGM.html#degree-distribution"><i class="fa fa-check"></i><b>3.4.1</b> Degree distribution</a></li>
<li class="chapter" data-level="3.4.2" data-path="RGM.html"><a href="RGM.html#edgewise-shared-partners-distribution"><i class="fa fa-check"></i><b>3.4.2</b> Edgewise shared partners distribution</a></li>
<li class="chapter" data-level="3.4.3" data-path="RGM.html"><a href="RGM.html#geodesic-distance-distribution"><i class="fa fa-check"></i><b>3.4.3</b> Geodesic distance distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="RGM.html"><a href="RGM.html#goodness-of-fit-diagnostics"><i class="fa fa-check"></i><b>3.5</b> Goodness of fit diagnostics</a><ul>
<li class="chapter" data-level="3.5.1" data-path="RGM.html"><a href="RGM.html#graphical-diagnostics"><i class="fa fa-check"></i><b>3.5.1</b> Graphical diagnostics</a></li>
<li class="chapter" data-level="3.5.2" data-path="RGM.html"><a href="RGM.html#summaries"><i class="fa fa-check"></i><b>3.5.2</b> Summaries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ERGMs.html"><a href="ERGMs.html"><i class="fa fa-check"></i><b>4</b> Exponential random graph models (ERGMs)</a><ul>
<li class="chapter" data-level="4.1" data-path="ERGMs.html"><a href="ERGMs.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="ERGMs.html"><a href="ERGMs.html#dependence-assumptions"><i class="fa fa-check"></i><b>4.2</b> Dependence assumptions</a><ul>
<li class="chapter" data-level="4.2.1" data-path="ERGMs.html"><a href="ERGMs.html#dyadic-independence"><i class="fa fa-check"></i><b>4.2.1</b> Dyadic independence</a></li>
<li class="chapter" data-level="4.2.2" data-path="ERGMs.html"><a href="ERGMs.html#dyadic-dependence"><i class="fa fa-check"></i><b>4.2.2</b> Dyadic dependence</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ERGMs.html"><a href="ERGMs.html#network-statistics-1"><i class="fa fa-check"></i><b>4.3</b> Network statistics</a><ul>
<li class="chapter" data-level="4.3.1" data-path="ERGMs.html"><a href="ERGMs.html#higher-order-network-statistics"><i class="fa fa-check"></i><b>4.3.1</b> Higher-order network statistics</a></li>
<li class="chapter" data-level="4.3.2" data-path="ERGMs.html"><a href="ERGMs.html#statistics-with-nodal-attributes-variables"><i class="fa fa-check"></i><b>4.3.2</b> Statistics with nodal attributes variables</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ERGMs.html"><a href="ERGMs.html#parameter-interpretation-1"><i class="fa fa-check"></i><b>4.4</b> Parameter interpretation</a></li>
<li class="chapter" data-level="4.5" data-path="ERGMs.html"><a href="ERGMs.html#network-simulation-1"><i class="fa fa-check"></i><b>4.5</b> Network simulation</a><ul>
<li class="chapter" data-level="4.5.1" data-path="ERGMs.html"><a href="ERGMs.html#trace-and-density-plots"><i class="fa fa-check"></i><b>4.5.1</b> Trace and density plots</a></li>
<li class="chapter" data-level="4.5.2" data-path="ERGMs.html"><a href="ERGMs.html#auto-correlation-plots"><i class="fa fa-check"></i><b>4.5.2</b> Auto-correlation plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="MLE-ERGMs.html"><a href="MLE-ERGMs.html"><i class="fa fa-check"></i><b>5</b> Maximum likelihood estimation for ERGMs</a><ul>
<li class="chapter" data-level="5.1" data-path="MLE-ERGMs.html"><a href="MLE-ERGMs.html#monte-carlo-maximum-likelihood-estimation-mc-mle"><i class="fa fa-check"></i><b>5.1</b> Monte Carlo maximum likelihood estimation (MC-MLE)</a></li>
<li class="chapter" data-level="5.2" data-path="MLE-ERGMs.html"><a href="MLE-ERGMs.html#goodness-of-fit-diagnostics-1"><i class="fa fa-check"></i><b>5.2</b> Goodness of fit diagnostics</a><ul>
<li class="chapter" data-level="5.2.1" data-path="MLE-ERGMs.html"><a href="MLE-ERGMs.html#graphical-diagnostics-1"><i class="fa fa-check"></i><b>5.2.1</b> Graphical diagnostics</a></li>
<li class="chapter" data-level="5.2.2" data-path="MLE-ERGMs.html"><a href="MLE-ERGMs.html#summaries-1"><i class="fa fa-check"></i><b>5.2.2</b> Summaries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Bayes-ERGMs.html"><a href="Bayes-ERGMs.html"><i class="fa fa-check"></i><b>6</b> Bayesian inference for ERGMs</a><ul>
<li class="chapter" data-level="6.1" data-path="Bayes-ERGMs.html"><a href="Bayes-ERGMs.html#parameter-inference-via-approximate-exchange-algorithm"><i class="fa fa-check"></i><b>6.1</b> Parameter inference via approximate exchange algorithm</a><ul>
<li class="chapter" data-level="6.1.1" data-path="Bayes-ERGMs.html"><a href="Bayes-ERGMs.html#parallel-adaptive-direction-sampler"><i class="fa fa-check"></i><b>6.1.1</b> Parallel adaptive direction sampler</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="Bayes-ERGMs.html"><a href="Bayes-ERGMs.html#prior-specification"><i class="fa fa-check"></i><b>6.2</b> Prior specification</a></li>
<li class="chapter" data-level="6.3" data-path="Bayes-ERGMs.html"><a href="Bayes-ERGMs.html#bayesian-goodness-of-fit-diagnostics"><i class="fa fa-check"></i><b>6.3</b> Bayesian goodness of fit diagnostics</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exponential random graph models with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ERGMs" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Exponential random graph models (ERGMs)</h1>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">4.1</span> Introduction</h2>
<p>The basci assumption behind exponential random graph models (ERGMs) is that the observed network is generated by a stochastic process in which relational edges come into being in ways that may be shaped by the presence or absence of other edges (and possibly node-level attributes).</p>
<p>In other words, the network is conceptualized as a self-organizing system of relational edges. Substantively, the claim is that there are local processes that generate dyadic relations, and that these processes may depend on the surrounding social environment (i.e. on existing relations).</p>
<p>For example, we can assume that actors with similar attributes are more likely to form friendship edges (homophily), or that if two unconnected actors were connected to a third actor, at some point they are likely to form a friendship tie between them (transitivity). Note that in addition to the assumption of stochasticity, this description is also implicitly temporal and dynamic.</p>
<p><strong>Definition</strong> - The likelihood of an ERGM belongs to the exponential family of distributions and represents the probability distribution of a network graph <span class="math inline">\(y\)</span> given a vector of parameters <span class="math inline">\(\theta\)</span>: <span class="math display">\[
f(y\ |\ \theta) = \frac{\exp\{\theta^T s(y)\}}{c(\theta)}.
\]</span></p>
<p>This equation states that the probability of observing a given network graph <span class="math inline">\(y\)</span> is equal to the exponent of the observed graph statistics <span class="math inline">\(s(y)\)</span> which is a function of the network data <span class="math inline">\(y\)</span> and covariate information <span class="math inline">\(x\)</span> multiplied by parameter vector <span class="math inline">\(\theta\)</span> divided by a normalising constant term <span class="math inline">\(c(\theta)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(<span class="st">&#39;statnet&#39;</span>)</code></pre></div>
</div>
<div id="dependence-assumptions" class="section level2 tabset tabset-fade">
<h2><span class="header-section-number">4.2</span> Dependence assumptions</h2>
<p>Network statistics <span class="math inline">\(s(y)\)</span> imply different assumptions regarding the network dyadic dependence structure.</p>
<div id="dyadic-independence" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Dyadic independence</h3>
<p>Dyad independent network statistics imply independence between dyads: the presence or absence of a edge does not depend the connectivity structure of the overall network. The random graph model is a dyadic independence model as all possible distinct edges in the network are independent of one another: <span class="math display">\[
Y_{ij}\ |\ \eta \sim Bernoulli(\eta),\; \forall i \ne j.
\]</span></p>
</div>
<div id="dyadic-dependence" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Dyadic dependence</h3>
<p>Dyadic dependence is an unrealistic assumption in many circumstances.</p>
<p>Dyad dependent network statistics imply dependence between dyads: an edge between <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> is assumed to be dependent on other edges.</p>
<p>For example:</p>
<ul>
<li><strong>stars</strong> statistics assume that an edge between <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> is contingent on any possible edge involving node <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>.</li>
<li><strong>triadic</strong> statistics assume that an edge between <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> is contingent on any possible edge involving any node of the network connected to both <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>.</li>
</ul>
</div>
</div>
<div id="network-statistics-1" class="section level2">
<h2><span class="header-section-number">4.3</span> Network statistics</h2>
<p>Common network statistics (undirected networks):</p>
<ul>
<li><p><em>edge statistic</em>: the number of edges in the network. This statistic is commonly density effect</p></li>
<li><p><em><span class="math inline">\(k\)</span>-star statistics</em>: the number of <span class="math inline">\(k\)</span>-star structures (where generally <span class="math inline">\(k = 2\)</span> or <span class="math inline">\(k = 3\)</span>)</p></li>
<li><p><em>cyclic statistics</em>: the number of connected <span class="math inline">\(k\)</span>-cycles (where generally <span class="math inline">\(k = 3 \rightarrow\)</span> triangles)<br><br> <img src="SNA_BOOK_files/figure-html/unnamed-chunk-27-1.png" width="480" /></p></li>
</ul>
<p>To get a list of network statistics implemented in the <code>ergm</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">help</span>(<span class="st">&#39;ergm-terms&#39;</span>, <span class="st">&#39;ergm&#39;</span>)</code></pre></div>
<p>Let’s consider a random 53-node undirected network:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">17</span>)
N &lt;-<span class="st"> </span><span class="dv">53</span>
y &lt;-<span class="st"> </span><span class="kw">network</span>(N, <span class="dt">directed =</span> <span class="ot">FALSE</span>)
<span class="kw">plot</span>(y, <span class="dt">vertex.cex =</span> <span class="dv">2</span>, <span class="dt">vertex.col =</span> <span class="st">&quot;skyblue&quot;</span>)</code></pre></div>
<p><img src="SNA_BOOK_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Let’s consider an ERGM with the following network statistics:</p>
<ul>
<li>edges: <span class="math inline">\(s_1(y) = \sum_{i &lt; j} y_{ij}\)</span>;</li>
<li>2-stars: <span class="math inline">\(s_2(y) = \sum_{i &lt; j &lt; k} y_{ij}y_{ik}\)</span>;</li>
<li>triangles: <span class="math inline">\(s_3(y) = \sum_{i &lt; j &lt; k} y_{ij}y_{ik}y_{jk}\)</span>.</li>
</ul>
<p>The vector of observed network statistics <span class="math inline">\(s(y)\)</span> can be calculated using the <code>summary</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model<span class="fl">.1</span> &lt;-<span class="st"> </span>y ~<span class="st"> </span>edges +<span class="st"> </span><span class="kw">kstar</span>(<span class="dv">2</span>) +<span class="st"> </span>triangle
<span class="kw">summary</span>(model<span class="fl">.1</span>)</code></pre></div>
<pre><code>##    edges   kstar2 triangle 
##       64      157        4</code></pre>
<div id="higher-order-network-statistics" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Higher-order network statistics</h3>
<p>Simulation-based inferential procedures have brought to light model degeneracy problems related to ERGMs defined by traditional specification <span class="citation">(Schweinberger <a href="#ref-sch11">2011</a>)</span>. In order to overcome these issues, a new specification of network statistics based on <em>geometrically weighted</em> functions of extra-triadic network statistics distributions such as degree distributions have been proposed by <span class="citation">Snijders et al. (<a href="#ref-sni:pat:rob:han06">2006</a>)</span>.</p>
<p>Some of the geometrically weighted undirected network statistics that are common in empirical research are:</p>
<ul>
<li><em>Geometrically weighted degree statistic</em> (<code>gwdegree</code>) is a function of the degree counts <span class="math inline">\(D_d (y)\)</span> defined as the number of nodes in <span class="math inline">\(y\)</span> with degree <span class="math inline">\(d\)</span>:
<span class="math display">\[\begin{equation*}
gwdegree(y, \alpha) = 
\sum_d g_d (\alpha) D_d (y),
\end{equation*}\]</span>
where <span class="math inline">\(g_d (y)\)</span> is an exponential weight function defined as:
<span class="math display">\[\begin{equation*}
g_d (\alpha) = e^{\alpha} \left\{ 1 - \left( 1 - e ^{-\alpha} \right)^{d} \right\}. 
\end{equation*}\]</span></li>
</ul>
<p>This statistic expresses a version of preferential attachment <span class="citation">(Albert and Barabási <a href="#ref-alb:bar02">2002</a>)</span> with edges from low degree to high degree nodes being more probable than edges among low degree nodes.</p>
<ul>
<li><em>Geometrically weighted edgewise shared partner statistic</em> (<code>gwesp</code>) is a function of the edgewise shared partner statistics <span class="math inline">\(EP_d (y)\)</span> defined as the number of unordered connected pairs <span class="math inline">\((i, j)\)</span> (partners) that are both connected to exactly <span class="math inline">\(d\)</span> other nodes:
<span class="math display">\[\begin{equation*}
gwesp(y, \alpha) =
\sum_d g_d (\alpha) \; EP_d (y) =
\sum_d g_d (\alpha) \sum_{i &lt; j} y_{ij} \mathbb{I}_{ \left\{ \sum_k y_{ik} y_{jk} = d  \right\} },
\end{equation*}\]</span>
where <span class="math inline">\(\mathbb{I}_{\lbrace \cdot \rbrace}\)</span> is the indicator function. For directed networks the geometric weighting is over homogeneous shared partners only (i.e., only partners on a directed two-path connecting the nodes in the edge and in the same direction).</li>
</ul>
<p>This statistic provides a suitable representation of transitivity in social networks by taking into account high-order <span class="math inline">\(k\)</span>-triangles.</p>
<p>For example, let’s consider the following ERGM:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model<span class="fl">.2</span> &lt;-<span class="st"> </span>y ~<span class="st"> </span>edges +<span class="st"> </span><span class="kw">gwesp</span>(<span class="dt">decay =</span> <span class="dv">1</span>, <span class="dt">fixed =</span> <span class="ot">TRUE</span>)
<span class="kw">summary</span>(model<span class="fl">.2</span>)</code></pre></div>
<pre><code>##         edges gwesp.fixed.1 
##      64.00000      11.63212</code></pre>
</div>
<div id="statistics-with-nodal-attributes-variables" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Statistics with nodal attributes variables</h3>
<p>There are various ways of introducing node-level effects (node attributes) into ERGMs. We assume an vector <span class="math inline">\(X\)</span> of attribute variables is given.</p>
<p>In <em>social selection</em> models, attributes are assumed to be exogenous predictors of network edges <span class="citation">(G. Robins, Elliott, and Pattison <a href="#ref-rob:ell:pat01">2001</a>)</span>: edges tend to develop between actors with certain attribute values. This means that the interest is in the probability of the network graph <span class="math inline">\(y\)</span> given the observations of attributes <span class="math inline">\(x\)</span>: <span class="math inline">\(\Pr(Y = y|X = x)\)</span>.</p>
</div>
</div>
<div id="parameter-interpretation-1" class="section level2">
<h2><span class="header-section-number">4.4</span> Parameter interpretation</h2>
<p>The parameter estimates associated with the network effects expressed by the network statistics provide insights about the contribution of each network statistic to edge formation. ERGMs allow to establish a relationship between a binary outcome variable (presence/absence of an edge between nodes) and a group of predictor variables (network statistics). It models the logit-transformed probability as a linear relationship with the predictor variables.</p>
<p>The conditional log-odds of an edge between <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> is: <span class="math display">\[
\mathrm{logit} \left( \Pr(Y_{ij} = 1\ |\ Y_{-ij}, \theta ) \right) = \theta^T\ \Delta (s(y))_{ij}, 
\]</span> where <span class="math inline">\(\Delta (s(y))_{ij}\)</span> is the change in <span class="math inline">\(s(y)\)</span> when the value of <span class="math inline">\(Y_{ij}\)</span> switch value from 0 to 1. So the coefficient <span class="math inline">\(\theta\)</span> can be interpreted as the log-odds of an individual edge conditional on all others.</p>
</div>
<div id="network-simulation-1" class="section level2 tabset tabset-fade">
<h2><span class="header-section-number">4.5</span> Network simulation</h2>
<p>The ERGM normalising constant <span class="math inline">\(c(\theta)\)</span> is calculated over the sum of all possible graphs on <span class="math inline">\(N\)</span> nodes and it is therefore extremely difficult to evaluate in presence of extra-dyadic network statistics for all but trivially small graphs.</p>
<p>The simulation of graphs from the parameter values of the model can be generally provided by MCMC algorithms. One of the convenient ways to generate random graphs is by the Metropolis algorithm applied to an initial adjacency matrix <span class="math inline">\(Y^{(0)}\)</span> whose elements dyads are stochastically updated so that at each iteration <span class="math inline">\(t\)</span>, the procedure implies that <span class="math inline">\(Y^{(t-1)}\)</span> and <span class="math inline">\(Y^{(t)}\)</span> differs in only one dyad. This mechanism cycles through the whole matrix so as to produce a distribution <span class="math inline">\(Y^{(T)}\)</span> tends asymptotically to the desired random graph distribution.</p>
In practice the algorithm compares the probability of a proposed graph <span class="math inline">\(y&#39;\)</span> to the current one <span class="math inline">\(y_c\)</span> where <span class="math inline">\(y&#39;\)</span> is selected at each step by proposing a change in the current state of a single dyad <span class="math inline">\((i,j)\)</span>, i.e. creating a new edge or dropping an old edge and then decides whether or not accept the proposed network with the following acceptance probability:
<span class="math display">\[\begin{equation*}
\alpha 
   =\min
    \left\lbrace 
    1,\frac{p(y&#39;\ |\ \theta_0)\ q(y_c \rightarrow y&#39;)}
           {p(y_c\ |\ \theta_0)\ q(y&#39; \rightarrow y_c)}
    \right\rbrace 
   =\exp
    \left\lbrace 
    \theta_0^t 
    \left[
    s(y&#39;) - s(y_c)
    \right]
    \right\rbrace
\end{equation*}\]</span>
<p>where <span class="math inline">\(q(y_c \rightarrow y&#39;)\)</span> and <span class="math inline">\(q(y&#39; \rightarrow y_c)\)</span> denote the probability of <span class="math inline">\(y&#39;\)</span> given <span class="math inline">\(y_c\)</span> and of <span class="math inline">\(y_c\)</span> given <span class="math inline">\(y&#39;\)</span> respectively.</p>
<p>The behaviour of MCMC algorithm is dependent on the choice of the proposal density <span class="math inline">\(q(\cdot)\)</span> and on the network statistics <span class="math inline">\(s(\cdot)\)</span> although it is proven that in principle the Metropolis yields convergence to the target distribution.</p>
<p>Suppose we want to simulate undirected networks on 53 nodes from the same ERGM defined above with parameter values:</p>
<ul>
<li><span class="math inline">\(\theta_1 = -1.9\)</span>, parameter related to the edge statistic <span class="math inline">\(s_1(y)\)</span>;</li>
<li><span class="math inline">\(\theta_2 = -0.1\)</span>, parameter related to the 2-star statistic <span class="math inline">\(s_2(y)\)</span>;</li>
<li><span class="math inline">\(\theta_3 = 0.4\)</span>, parameter related to the triangle statistics <span class="math inline">\(s_3(y)\)</span>.</li>
</ul>
<p>We can use the <code>simulate</code> function to do that:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">11</span>)
y.sim &lt;-<span class="st"> </span><span class="kw">simulate</span>(<span class="kw">network</span>(N, <span class="dt">directed =</span> <span class="ot">FALSE</span>) ~<span class="st"> </span>edges +<span class="st"> </span><span class="kw">kstar</span>(<span class="dv">2</span>) +<span class="st"> </span>triangle, 
                  <span class="dt">coef =</span> <span class="kw">c</span>(-<span class="fl">1.9</span>, -<span class="fl">0.1</span>, <span class="fl">0.4</span>),
                  <span class="dt">statsonly =</span> <span class="ot">TRUE</span>,
                  <span class="dt">nsim =</span> <span class="dv">1000</span>,
                  <span class="dt">control =</span> <span class="kw">control.simulate.formula</span>(<span class="dt">MCMC.burnin =</span> <span class="dv">1000</span>,   <span class="co"># burnin </span>
                                                     <span class="dt">MCMC.interval =</span> <span class="dv">100</span>)) <span class="co"># mcmc thinning interval </span>
<span class="kw">summary</span>(y.sim)</code></pre></div>
<pre><code>##      edges         kstar2         triangle    
##  Min.   : 78   Min.   :214.0   Min.   : 0.00  
##  1st Qu.: 97   1st Qu.:326.8   1st Qu.: 8.00  
##  Median :102   Median :365.0   Median :11.00  
##  Mean   :102   Mean   :367.1   Mean   :11.18  
##  3rd Qu.:107   3rd Qu.:405.0   3rd Qu.:14.00  
##  Max.   :126   Max.   :597.0   Max.   :31.00</code></pre>
<p>We can analyse the MCMC output diagnostics using the <code>coda</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(coda)</code></pre></div>
<div id="trace-and-density-plots" class="section level3">
<h3><span class="header-section-number">4.5.1</span> Trace and density plots</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">mcmc</span>(y.sim))</code></pre></div>
<p><img src="SNA_BOOK_files/figure-html/unnamed-chunk-34-1.png" width="768" /></p>
</div>
<div id="auto-correlation-plots" class="section level3">
<h3><span class="header-section-number">4.5.2</span> Auto-correlation plots</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">acfplot</span>(<span class="kw">mcmc</span>(y.sim))</code></pre></div>
<p><img src="SNA_BOOK_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-sch11">
<p>Schweinberger, Michael. 2011. “Instability, Sensitivity, and Degeneracy of Discrete Exponential Families.” <em>Journal of the American Statistical Association</em> 106 (496). Taylor &amp; Francis: 1361–70.</p>
</div>
<div id="ref-sni:pat:rob:han06">
<p>Snijders, T. A. B., P. E. Pattison, G. L. Robins, and Handcock M. S. 2006. “New Specifications for Exponential Random Graph Models.” <em>Sociological Methodology</em> 36: 99–153.</p>
</div>
<div id="ref-alb:bar02">
<p>Albert, Réka, and Albert László Barabási. 2002. “Statistical Mechanics of Complex Networks.” <em>Reviews of Modern Physics</em> 74 (1). APS: 47.</p>
</div>
<div id="ref-rob:ell:pat01">
<p>Robins, Garry, Peter Elliott, and Philippa Pattison. 2001. “Network Models for Social Selection Processes.” <em>Social Networks</em> 23 (1). Elsevier: 1–30.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="RGM.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="MLE-ERGMs.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-ERGMs.Rmd",
"text": "Edit"
},
"download": ["SNA_BOOK.pdf", "SNA_BOOK.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
