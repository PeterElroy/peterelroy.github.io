<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Exponential random graph models with R</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Exponential random graph models with R">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Exponential random graph models with R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Exponential random graph models with R" />
  
  
  

<meta name="author" content="Alberto Caimo and Isabella Gollini">


<meta name="date" content="2017-04-10">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="ERGMs.html">
<link rel="next" href="Bayes-ERGMs.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Network Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the authors</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#alberto-caimo"><i class="fa fa-check"></i>Alberto Caimo</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#isabella-gollini"><i class="fa fa-check"></i>Isabella Gollini</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="Rbasics.html"><a href="Rbasics.html"><i class="fa fa-check"></i><b>2</b> R basics</a><ul>
<li class="chapter" data-level="2.1" data-path="Rbasics.html"><a href="Rbasics.html#fundamentals"><i class="fa fa-check"></i><b>2.1</b> Fundamentals</a></li>
<li class="chapter" data-level="2.2" data-path="Rbasics.html"><a href="Rbasics.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.2</b> R and RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="Rbasics.html"><a href="Rbasics.html#package-repositories"><i class="fa fa-check"></i><b>2.3</b> Package repositories</a></li>
<li class="chapter" data-level="2.4" data-path="Rbasics.html"><a href="Rbasics.html#r-packages-for-statistical-network-analysis"><i class="fa fa-check"></i><b>2.4</b> R packages for statistical network analysis</a><ul>
<li class="chapter" data-level="2.4.1" data-path="Rbasics.html"><a href="Rbasics.html#statnet"><i class="fa fa-check"></i><b>2.4.1</b> <code>statnet</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="Rbasics.html"><a href="Rbasics.html#bergm"><i class="fa fa-check"></i><b>2.4.2</b> <code>Bergm</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="RGM.html"><a href="RGM.html"><i class="fa fa-check"></i><b>3</b> The random graph model</a><ul>
<li class="chapter" data-level="3.1" data-path="RGM.html"><a href="RGM.html#networks-as-random-graphs"><i class="fa fa-check"></i><b>3.1</b> Networks as random graphs</a><ul>
<li class="chapter" data-level="3.1.1" data-path="RGM.html"><a href="RGM.html#notation"><i class="fa fa-check"></i><b>3.1.1</b> Notation</a></li>
<li class="chapter" data-level="3.1.2" data-path="RGM.html"><a href="RGM.html#visualisation"><i class="fa fa-check"></i><b>3.1.2</b> Visualisation</a></li>
<li class="chapter" data-level="3.1.3" data-path="RGM.html"><a href="RGM.html#number-of-dyads"><i class="fa fa-check"></i><b>3.1.3</b> Number of dyads</a></li>
<li class="chapter" data-level="3.1.4" data-path="RGM.html"><a href="RGM.html#number-of-edges"><i class="fa fa-check"></i><b>3.1.4</b> Number of edges</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="RGM.html"><a href="RGM.html#random-graph-model"><i class="fa fa-check"></i><b>3.2</b> Random graph model</a><ul>
<li class="chapter" data-level="3.2.1" data-path="RGM.html"><a href="RGM.html#estimation"><i class="fa fa-check"></i><b>3.2.1</b> Estimation</a></li>
<li class="chapter" data-level="3.2.2" data-path="RGM.html"><a href="RGM.html#natural-parametrisation"><i class="fa fa-check"></i><b>3.2.2</b> Natural parametrisation</a></li>
<li class="chapter" data-level="3.2.3" data-path="RGM.html"><a href="RGM.html#parameter-interpretation"><i class="fa fa-check"></i><b>3.2.3</b> Parameter interpretation</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="RGM.html"><a href="RGM.html#network-simulation"><i class="fa fa-check"></i><b>3.3</b> Network simulation</a><ul>
<li class="chapter" data-level="3.3.1" data-path="RGM.html"><a href="RGM.html#histogram"><i class="fa fa-check"></i><b>3.3.1</b> Histogram</a></li>
<li class="chapter" data-level="3.3.2" data-path="RGM.html"><a href="RGM.html#boxplot"><i class="fa fa-check"></i><b>3.3.2</b> Boxplot</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="RGM.html"><a href="RGM.html#network-statistics"><i class="fa fa-check"></i><b>3.4</b> Network statistics</a><ul>
<li class="chapter" data-level="3.4.1" data-path="RGM.html"><a href="RGM.html#degree-distribution"><i class="fa fa-check"></i><b>3.4.1</b> Degree distribution</a></li>
<li class="chapter" data-level="3.4.2" data-path="RGM.html"><a href="RGM.html#edgewise-shared-partners-distribution"><i class="fa fa-check"></i><b>3.4.2</b> Edgewise shared partners distribution</a></li>
<li class="chapter" data-level="3.4.3" data-path="RGM.html"><a href="RGM.html#geodesic-distance-distribution"><i class="fa fa-check"></i><b>3.4.3</b> Geodesic distance distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="RGM.html"><a href="RGM.html#goodness-of-fit-diagnostics"><i class="fa fa-check"></i><b>3.5</b> Goodness of fit diagnostics</a><ul>
<li class="chapter" data-level="3.5.1" data-path="RGM.html"><a href="RGM.html#graphical-diagnostics"><i class="fa fa-check"></i><b>3.5.1</b> Graphical diagnostics</a></li>
<li class="chapter" data-level="3.5.2" data-path="RGM.html"><a href="RGM.html#summaries"><i class="fa fa-check"></i><b>3.5.2</b> Summaries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ERGMs.html"><a href="ERGMs.html"><i class="fa fa-check"></i><b>4</b> Exponential random graph models (ERGMs)</a><ul>
<li class="chapter" data-level="4.1" data-path="ERGMs.html"><a href="ERGMs.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="ERGMs.html"><a href="ERGMs.html#dependence-assumptions"><i class="fa fa-check"></i><b>4.2</b> Dependence assumptions</a><ul>
<li class="chapter" data-level="4.2.1" data-path="ERGMs.html"><a href="ERGMs.html#dyadic-independence"><i class="fa fa-check"></i><b>4.2.1</b> Dyadic independence</a></li>
<li class="chapter" data-level="4.2.2" data-path="ERGMs.html"><a href="ERGMs.html#dyadic-dependence"><i class="fa fa-check"></i><b>4.2.2</b> Dyadic dependence</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ERGMs.html"><a href="ERGMs.html#network-statistics-1"><i class="fa fa-check"></i><b>4.3</b> Network statistics</a><ul>
<li class="chapter" data-level="4.3.1" data-path="ERGMs.html"><a href="ERGMs.html#higher-order-network-statistics"><i class="fa fa-check"></i><b>4.3.1</b> Higher-order network statistics</a></li>
<li class="chapter" data-level="4.3.2" data-path="ERGMs.html"><a href="ERGMs.html#statistics-with-nodal-attributes-variables"><i class="fa fa-check"></i><b>4.3.2</b> Statistics with nodal attributes variables</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ERGMs.html"><a href="ERGMs.html#parameter-interpretation-1"><i class="fa fa-check"></i><b>4.4</b> Parameter interpretation</a></li>
<li class="chapter" data-level="4.5" data-path="ERGMs.html"><a href="ERGMs.html#network-simulation-1"><i class="fa fa-check"></i><b>4.5</b> Network simulation</a><ul>
<li class="chapter" data-level="4.5.1" data-path="ERGMs.html"><a href="ERGMs.html#trace-and-density-plots"><i class="fa fa-check"></i><b>4.5.1</b> Trace and density plots</a></li>
<li class="chapter" data-level="4.5.2" data-path="ERGMs.html"><a href="ERGMs.html#auto-correlation-plots"><i class="fa fa-check"></i><b>4.5.2</b> Auto-correlation plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="MLE-ERGMs.html"><a href="MLE-ERGMs.html"><i class="fa fa-check"></i><b>5</b> Maximum likelihood estimation for ERGMs</a><ul>
<li class="chapter" data-level="5.1" data-path="MLE-ERGMs.html"><a href="MLE-ERGMs.html#monte-carlo-maximum-likelihood-estimation-mc-mle"><i class="fa fa-check"></i><b>5.1</b> Monte Carlo maximum likelihood estimation (MC-MLE)</a></li>
<li class="chapter" data-level="5.2" data-path="MLE-ERGMs.html"><a href="MLE-ERGMs.html#goodness-of-fit-diagnostics-1"><i class="fa fa-check"></i><b>5.2</b> Goodness of fit diagnostics</a><ul>
<li class="chapter" data-level="5.2.1" data-path="MLE-ERGMs.html"><a href="MLE-ERGMs.html#graphical-diagnostics-1"><i class="fa fa-check"></i><b>5.2.1</b> Graphical diagnostics</a></li>
<li class="chapter" data-level="5.2.2" data-path="MLE-ERGMs.html"><a href="MLE-ERGMs.html#summaries-1"><i class="fa fa-check"></i><b>5.2.2</b> Summaries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Bayes-ERGMs.html"><a href="Bayes-ERGMs.html"><i class="fa fa-check"></i><b>6</b> Bayesian inference for ERGMs</a><ul>
<li class="chapter" data-level="6.1" data-path="Bayes-ERGMs.html"><a href="Bayes-ERGMs.html#parameter-inference-via-approximate-exchange-algorithm"><i class="fa fa-check"></i><b>6.1</b> Parameter inference via approximate exchange algorithm</a><ul>
<li class="chapter" data-level="6.1.1" data-path="Bayes-ERGMs.html"><a href="Bayes-ERGMs.html#parallel-adaptive-direction-sampler"><i class="fa fa-check"></i><b>6.1.1</b> Parallel adaptive direction sampler</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="Bayes-ERGMs.html"><a href="Bayes-ERGMs.html#prior-specification"><i class="fa fa-check"></i><b>6.2</b> Prior specification</a></li>
<li class="chapter" data-level="6.3" data-path="Bayes-ERGMs.html"><a href="Bayes-ERGMs.html#bayesian-goodness-of-fit-diagnostics"><i class="fa fa-check"></i><b>6.3</b> Bayesian goodness of fit diagnostics</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exponential random graph models with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="MLE_ERGMs" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Maximum likelihood estimation for ERGMs</h1>
<p>The estimation procedure starts assuming that the observed network <span class="math inline">\(y\)</span> is just one realization of a set of many possible networks that could have been formed by the same underlying structural processes. Each network statistic <span class="math inline">\(s(y)\)</span> is conceptualised as having a particular probability of occurring which is incorporated into the model as a parameter vector <span class="math inline">\(\theta\)</span>.</p>
The aim of the estimation is to find accurately a parameter value so that the observed network has the highest possible likelihood of being simulated by the given model. In other words, when attempting to generate an ERGM we find the set of parameters which maximise the probability that any random network graph generated by simulating from the ERGM will be identical to the observed network in terms of network statistics:
<span class="math display">\[\begin{equation*}
\mathbb{E}_{y\ |\ \theta}\left[s(y)\right] = s(y)
\end{equation*}\]</span>
<p>where <span class="math inline">\(\mathbb{E}_{y\ |\ \theta}\)</span> is the expectation under the likelihood distribution <span class="math inline">\(p(y\ |\ \theta)\)</span> so that it ensures that the probability mass of the ERGM is centred at <span class="math inline">\(s(y)\)</span>.</p>
<p>In practice, an exact solution for the ERGM is actually impossible to calculate directly due to the <strong>intractability</strong> of the normalising constant <span class="math inline">\(c(\theta)\)</span>.</p>
<div id="monte-carlo-maximum-likelihood-estimation-mc-mle" class="section level2">
<h2><span class="header-section-number">5.1</span> Monte Carlo maximum likelihood estimation (MC-MLE)</h2>
<p>The most advanced classical estimation method used is the Monte Carlo Maximum Likelihood Estimation (MC-MLE) procedure proposed by <a href="http://www.jstor.org/stable/2345852">Geyer and Thompson (1992)</a>.</p>
<p>This involves the simulation of a set of random networks from a starting set of estimated parameter values <span class="math inline">\(\theta_0\)</span>, and then the progressive refinement (until convergence) of the parameter values by measuring how closely these networks match the observed network.</p>
Let’s denote with <span class="math inline">\(q_{\theta}(y) = \exp\{ \theta^t s(y) \}\)</span> the unnormalised likelihood. Mathematically, the key identity of the MC-MLE method is the following:
<span class="math display">\[\begin{align}
\frac {c(\theta)} {c(\theta_0)} 
= \mathbb{E}_{y\ |\ \theta_0} 
\left[ 
\frac {q_{\theta}(y)} {q_{\theta_0}(y)} 
\right] 
&amp;= \sum_{y} 
\frac {q_{\theta}(y)} {q_{\theta_0}(y)} 
\frac {q_{\theta_0}(y)} {z(\theta_0)} \label{eqn:key}
\\
&amp;\approx \frac{1}{m}\sum_{i=1}^m \exp\left\{ (\theta-\theta_0)^t s(y_i) \right\}\notag
\end{align}\]</span>
<p>where <span class="math inline">\(q(\cdot)\)</span> is the unnormalised likelihood, <span class="math inline">\(\theta_0\)</span> is fixed set of parameter values, and <span class="math inline">\(\mathbb{E}_{y\ |\ \theta_0}\)</span> denotes an expectation taken with respect to the distribution <span class="math inline">\(p(y\ |\ \theta_0)\)</span>. In practice this ratio of normalising constants is approximated using graphs <span class="math inline">\(y_1,\dots,y_m\)</span> sampled via MCMC from <span class="math inline">\(p(y\ |\ \theta_0)\)</span> and importance sampling.</p>
This yields the following approximated log likelihood ratio:
<span class="math display">\[\begin{equation} 
w_{\theta_0}(\theta)=\ell(\theta)-\ell(\theta_0) \approx (\theta - \theta_0)^t s(y) - 
\log\left[ \frac{1}{m}\sum_{i=1}^m \exp\left\{ (\theta-\theta_0)^t s(y_i) \right\} \right] 
\label{eqn:gey:thom}
\end{equation}\]</span>
<p>where <span class="math inline">\(\ell(\cdot)\)</span> is the log-likelihood. <span class="math inline">\(w_{\theta_0}\)</span> is a function of <span class="math inline">\(\theta\)</span>, and its maximum value serves as a Monte Carlo estimate of the MLE.</p>
<p>A crucial aspect of this algorithm is the choice of <span class="math inline">\(\theta_0\)</span>. Ideally <span class="math inline">\(\theta_0\)</span> should be very close to the maximum likelihood estimator of <span class="math inline">\(\theta\)</span>. Viewed as a function of <span class="math inline">\(\theta\)</span>, <span class="math inline">\(w_{\theta_0}(\theta)\)</span> is very sensitive to the choice of <span class="math inline">\(\theta_0\)</span>. A poorly chosen value of <span class="math inline">\(\theta_0\)</span> may lead to an objective function that cannot even be maximised.</p>
<p>The result of the MC-MLE procedure is a set of estimated parameter values and relative standard errors which measure the degree of accuracy and significance of the estimates.</p>
<p>To implement the MC-MLE procedure we can use the <code>ergm</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">11</span>)
model<span class="fl">.2</span> &lt;-<span class="st"> </span>y ~<span class="st"> </span>edges +<span class="st"> </span>
<span class="st">               </span><span class="kw">gwesp</span>(<span class="dt">decay =</span> <span class="dv">1</span>, <span class="dt">fixed =</span> <span class="ot">TRUE</span>) +<span class="st"> </span>
<span class="st">               </span><span class="kw">gwnsp</span>(<span class="dt">decay =</span> <span class="dv">1</span>, <span class="dt">fixed =</span> <span class="ot">TRUE</span>)
MLE<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">ergm</span>(model<span class="fl">.2</span>)</code></pre></div>
<pre><code>## Starting maximum likelihood estimation via MCMLE:
## Iteration 1 of at most 20: 
## The log-likelihood improved by 0.004112 
## Step length converged once. Increasing MCMC sample size.
## Iteration 2 of at most 20: 
## The log-likelihood improved by 0.0082 
## Step length converged twice. Stopping.
## Evaluating log-likelihood at the estimate. Using 20 bridges: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 .
## 
## This model was fit using MCMC.  To examine model diagnostics and check for degeneracy, use the mcmc.diagnostics() function.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(MLE<span class="fl">.2</span>)</code></pre></div>
<pre><code>## 
## ==========================
## Summary of model fit
## ==========================
## 
## Formula:   y ~ edges + gwesp(decay = 1, fixed = TRUE) + gwnsp(decay = 1, 
##     fixed = TRUE)
## 
## Iterations:  2 out of 20 
## 
## Monte Carlo MLE Results:
##                Estimate Std. Error MCMC % p-value    
## edges         -3.126974   0.414423      0  &lt;1e-04 ***
## gwesp.fixed.1  0.194962   0.179318      0   0.277    
## gwnsp.fixed.1  0.004851   0.089213      0   0.957    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##      Null Deviance: 1910  on 1378  degrees of freedom
##  Residual Deviance:  517  on 1375  degrees of freedom
##  
## AIC: 523    BIC: 538.6    (Smaller is better.)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc.diagnostics</span>(MLE<span class="fl">.2</span>)</code></pre></div>
<pre><code>## Sample statistics summary:
## 
## Iterations = 16384:4209664
## Thinning interval = 1024 
## Number of chains = 1 
## Sample size per chain = 4096 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##                 Mean     SD Naive SE Time-series SE
## edges         1.0830  8.514   0.1330         0.1265
## gwesp.fixed.1 0.5493  7.271   0.1136         0.1136
## gwnsp.fixed.1 4.4974 38.127   0.5957         0.5957
## 
## 2. Quantiles for each variable:
## 
##                 2.5%     25%       50%    75% 97.5%
## edges         -15.00  -5.000 1.000e+00  7.000 18.00
## gwesp.fixed.1 -11.63  -5.632 3.451e-13  5.264 17.26
## gwnsp.fixed.1 -60.49 -22.240 8.964e-01 28.528 85.71
## 
## 
## Sample statistics cross-correlations:
##                   edges gwesp.fixed.1 gwnsp.fixed.1
## edges         1.0000000     0.6410327     0.9557442
## gwesp.fixed.1 0.6410327     1.0000000     0.6050813
## gwnsp.fixed.1 0.9557442     0.6050813     1.0000000
## 
## Sample statistics auto-correlation:
## Chain 1 
##                 edges gwesp.fixed.1 gwnsp.fixed.1
## Lag 0     1.000000000   1.000000000  1.000000e+00
## Lag 1024  0.003546387   0.020586964  3.443736e-05
## Lag 2048 -0.021609688  -0.007190510 -2.622667e-02
## Lag 3072 -0.032834876   0.007026375 -2.331004e-02
## Lag 4096 -0.013443575  -0.009443708 -1.369215e-02
## Lag 5120  0.008690002  -0.010584478  1.835021e-02
## 
## Sample statistics burn-in diagnostic (Geweke):
## Chain 1 
## 
## Fraction in 1st window = 0.1
## Fraction in 2nd window = 0.5 
## 
##         edges gwesp.fixed.1 gwnsp.fixed.1 
##       -1.7545       -0.9937       -2.2127 
## 
## Individual P-values (lower = worse):
##         edges gwesp.fixed.1 gwnsp.fixed.1 
##    0.07934137    0.32037506    0.02691517 
## Joint P-value (lower = worse):  0.1506554 .</code></pre>
<p><img src="SNA_BOOK_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<pre><code>## 
## MCMC diagnostics shown here are from the last round of simulation, prior to computation of final parameter estimates. Because the final estimates are refinements of those used for this simulation run, these diagnostics may understate model performance. To directly assess the performance of the final model on in-model statistics, please use the GOF command: gof(ergmFitObject, GOF=~model).</code></pre>
</div>
<div id="goodness-of-fit-diagnostics-1" class="section level2 tabset tabset-fade">
<h2><span class="header-section-number">5.2</span> Goodness of fit diagnostics</h2>
<p>If the estimated ERGM is a good fit to the observed data, then networks simulated <span class="math inline">\(y_1, \dots, y_m\)</span> from its MLE should resemble the connectivity structure of the observed data <span class="math inline">\(y\)</span>.</p>
<p>To do this, <span class="math inline">\(m = 100\)</span> graphs are simulated from the maximum likelihood estimate of the parameter vector <span class="math inline">\(\hat{\theta}\)</span> and compared to the observed graph in terms of high-level network statistics which are not modelled explicitly:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model<span class="fl">.2</span>.gof &lt;-<span class="st"> </span><span class="kw">gof</span>(MLE<span class="fl">.2</span> ~<span class="st"> </span>degree +<span class="st"> </span>esp +<span class="st"> </span>distance,
                   <span class="kw">control.gof.formula</span>(<span class="dt">nsim =</span> <span class="dv">100</span>))</code></pre></div>
<div id="graphical-diagnostics-1" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Graphical diagnostics</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))
<span class="kw">plot</span>(model<span class="fl">.2</span>.gof, <span class="dt">main =</span> <span class="st">&#39;&#39;</span>)</code></pre></div>
<p><img src="SNA_BOOK_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
</div>
<div id="summaries-1" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Summaries</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(model<span class="fl">.2</span>.gof)</code></pre></div>
<pre><code>## 
## Goodness-of-fit for degree 
## 
##    obs min  mean max MC p-value
## 0    5   0  4.79  10       1.00
## 1    9   4 11.80  22       0.42
## 2   16   5 14.10  22       0.72
## 3   14   5 10.95  20       0.36
## 4    5   1  6.46  12       0.70
## 5    2   0  2.68  10       1.00
## 6    0   0  1.53   7       0.44
## 7    1   0  0.48   2       0.74
## 8    1   0  0.13   2       0.22
## 9    0   0  0.07   1       1.00
## 10   0   0  0.01   1       1.00
## 
## Goodness-of-fit for edgewise shared partner 
## 
##      obs min  mean max MC p-value
## esp0  53  35 52.57  76       0.96
## esp1  10   0  9.61  29       0.82
## esp2   1   0  0.97   8       0.86
## esp3   0   0  0.05   1       1.00
## 
## Goodness-of-fit for minimum geodesic distance 
## 
##     obs min   mean max MC p-value
## 1    64  43  63.20  86       0.96
## 2   136  55 132.85 234       0.88
## 3   219  63 213.89 385       0.86
## 4   257  68 239.57 383       0.90
## 5   215  59 185.51 269       0.58
## 6   140  20 109.02 197       0.42
## 7    68   0  57.13 133       0.72
## 8    22   0  28.33 109       1.00
## 9     5   0  14.27  86       0.92
## 10    2   0   6.77  68       0.92
## 11    0   0   3.15  44       1.00
## 12    0   0   1.38  22       1.00
## 13    0   0   0.40   9       1.00
## 14    0   0   0.06   2       1.00
## Inf 250  52 322.47 931       0.84</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ERGMs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Bayes-ERGMs.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-MLE_ERGMs.Rmd",
"text": "Edit"
},
"download": ["SNA_BOOK.pdf", "SNA_BOOK.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
